import { Component, ViewEncapsulation, Input, OnInit } from '@angular/core';
import { OdenFormService } from '../../../core/services/oden-form.service';
import { OdenIssueBaseComponent } from '../oden-form-base-classes/oden-issue-base-component';
import { AbstractControl } from '@angular/forms';

@Component({
    selector: 'oden-error',
    templateUrl: 'oden-error.component.html',
    encapsulation: ViewEncapsulation.None
})
export class OdenErrorComponent extends OdenIssueBaseComponent implements OnInit {
    @Input() errorCode: string;

    constructor(private _formService: OdenFormService) {
        super();
    }

    ngOnInit(): void {
        this._subscriptions.push(this._formService._statusChanged.subscribe((control: AbstractControl) => this._setHasError(control)));
    }

    public _setHasError(control: AbstractControl) {
        this.show = control.hasError(this.errorCode);
    }
}
