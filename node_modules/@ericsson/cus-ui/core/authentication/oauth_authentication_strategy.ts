import { Injectable } from '@angular/core';
import { AuthenticationStrategy } from './authentication_strategy';

@Injectable()
export class OAuthAuthenticationStrategy implements AuthenticationStrategy {
    /* tslint:disable */
    getHeaders(): Map<string, string> {
        let headers: Map<string, string> = new Map<string, string>();
        if (this.getJWTToken()) {
            headers.set('Authorization', `Bearer ${this.getJWTToken()}`);
        }
        return headers;
    }

    private getJWTToken(): string {
        let bearerToken = localStorage.getItem('JWT_TOKEN');
        return bearerToken ? bearerToken : '';
    }
}
