export class Utils {
    /**
     * Return promise of the resolved url
     */
    static loadScript(src: string): Promise<any> {
        return new Promise(function (resolve, reject) {
            // percent encode just "#" for HTTP requests
            src = src.replace(/#/g, '%23');
            let script = document.createElement('script');
            script.type = 'text/javascript';
            script.charset = 'utf-8';
            script.async = true;
            script.addEventListener('load', load, false);
            script.addEventListener('error', error, false);
            script.src = src;
            document.head.appendChild(script);

            function load() {
                resolve();
                cleanup();
            }

            // note this does not catch execution errors
            function error(err) {
                cleanup();
                reject(new Error('Fetching ' + err));
            }

            function cleanup() {
                script.removeEventListener('load', load, false);
                script.removeEventListener('error', error, false);
                document.head.removeChild(script);
            }

        });
    }

}
