'use strict';

// SystemJS configuration file, see links for more information
// https://github.com/systemjs/systemjs
// https://github.com/systemjs/systemjs/blob/master/docs/config-api.md
/***********************************************************************************************
 * User Configuration.
 **********************************************************************************************/
/** Map relative paths to URLs. */
const odenMappingFile = '@ericsson/oden/configs/system-mappings.json'
const cusUIMappingFile = '@ericsson/cus-ui/cus-ui-mappings.json';
let oden_mappings = [];
let cus_ui_mappings = [];

// Make sure to require oden packages and mappings in build time.
if (oden_mappings.length === 0) {
    oden_mappings = require(odenMappingFile);
}

if (cus_ui_mappings.length === 0) {
    cus_ui_mappings = require(cusUIMappingFile);
}

const new_maps = {
    app: 'app',
    '@angular/core': 'node_modules/@angular/core/bundles/core.umd.js',
    '@angular/common': 'node_modules/@angular/common/bundles/common.umd.js',
    '@angular/common/http': 'node_modules/@angular/common/bundles/common-http.umd.js',
    '@angular/common/src/facade/async': 'node_modules/@angular/common/src/facade/async.js',
    '@angular/compiler': 'node_modules/@angular/compiler/bundles/compiler.umd.js',
    '@angular/animations': 'node_modules/@angular/animations/bundles/animations.umd.js',
    '@angular/animations/browser': 'node_modules/@angular/animations/bundles/animations-browser.umd.js',
    '@angular/platform-browser/animations': 'node_modules/@angular/platform-browser/bundles/platform-browser-animations.umd.js',
    '@angular/platform-browser': 'node_modules/@angular/platform-browser/bundles/platform-browser.umd.js',
    '@angular/platform-browser-dynamic': 'node_modules/@angular/platform-browser-dynamic/bundles/platform-browser-dynamic.umd.js',
    '@angular/http': 'node_modules/@angular/http/bundles/http.umd.js',
    '@angular/router': 'node_modules/@angular/router/bundles/router.umd.js',
    '@angular/forms': 'node_modules/@angular/forms/bundles/forms.umd.js',
    'd3': 'node_modules/d3/build/d3.js',
    'rxjs': 'node_modules/rxjs',
    'systemjs': 'node_modules/systemjs',
    'core-js': 'node_modules/core-js',
    'zone.js': 'node_modules/zone.js',
    'classlist.js': 'node_modules/classlist.js',
    'web-animations-js': 'node_modules/web-animations-js/web-animations.min.js',
    'reflect-metadata': 'node_modules/reflect-metadata',
    'main': 'main.js',
    '@ericsson/oden': 'node_modules/@ericsson/oden',
    '@ericsson/cus-ui': 'node_modules/@ericsson/cus-ui',
    'angular2-text-mask': 'node_modules/angular2-text-mask/dist/angular2TextMask.js',
    'moment': 'node_modules/moment',
    'text-mask-core/dist/textMaskCore': 'node_modules/text-mask-core/dist/textMaskCore.js',
    'text-mask-addons/dist/createAutoCorrectedDatePipe': 'node_modules/text-mask-addons/dist/createAutoCorrectedDatePipe.js',
    'hammerjs': 'node_modules/hammerjs',
    'lodash': 'node_modules/lodash',
    '@ngx-translate/core': 'node_modules/@ngx-translate/core/bundles/core.umd.js',
    '@ngx-translate/http-loader': 'node_modules/@ngx-translate/http-loader/bundles/http-loader.umd.js',
    'tslib': 'node_modules/tslib',
    'big.js': 'node_modules/big.js',
    '@ericsson/oden/core/models/modal-action-item.model': 'node_modules/@ericsson/oden/core.js',
    'pako': 'node_modules/pako',
    'jsonpath': 'node_modules/jsonpath',
    'jszip': 'node_modules/jszip/dist/jszip.js',
    'messageformat': 'node_modules/messageformat/messageformat.js',
    'file-saver': 'node_modules/file-saver/dist/FileSaver.js'
};

const new_packages = {
    app: { main: 'index', defaultExtension: 'js' },
    'environments': { main: 'environment.prod' },
    'polyfill': { main: 'polyfills' },
    '@angular/core': { defaultExtension: false },
    rxjs: { main: 'Rx', defaultExtension: 'js' },
    'systemjs': { defaultExtension: 'js' },
    'core-js': { defaultExtension: 'js' },
    '@ericsson/oden': { main: 'index', defaultExtension: 'js' },
    'reflect-metadata': { main: 'Reflect.js' },
    'zone.js': { defaultExtension: 'js' },
    'classlist.js': { main: 'classList', defaultExtension: 'js' },
    'web-animations-js': { defaultExtension: 'js' },
    'moment': { main: 'moment', defaultExtension: 'js' },
    'hammerjs': { main: 'hammer', defaultExtension: 'js' },
    'lodash': { main: 'lodash', defaultExtension: 'js' },
    '@ngx-translate/core': { defaultExtension: 'js' },
    '@ngx-translate/http-loader': { defaultExtension: 'js' },
    'tslib': { main: 'tslib', defaultExtension: 'js' },
    'big.js': { main: 'big', defaultExtension: 'js' },
    'pako': { main: 'index', defaultExtension: 'js' },
    'jsonpath': { main: 'jsonpath', defaultExtension: 'js' },
    'file-saver': { defaultExtension: 'js' }
};

/* tslint:disable */
for (let i in oden_mappings) {
    new_packages[i] = { main: 'index', defaultExtension: 'js' };
};

for (let i in cus_ui_mappings) {
    new_packages[i] = { main: 'index', defaultExtension: 'js' };
};

// Apply the  SystemJS configuration.
System.config({
    map: Object.assign(new_maps, oden_mappings, cus_ui_mappings),
    packages: new_packages
});
