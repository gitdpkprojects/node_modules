import { Routes } from '@angular/router';
import { UniversalOverlayComponent } from '../../common';
import { GuideModule } from '../../task/guide';

let appConfig = null;

export const routes: Routes = [
];

export const taskRoutes: Routes = [
];

export function loadAppConfig() {
  if (!appConfig) {
    appConfig = require('../../../../../src/app.configs').AppConfig;
    buildRoutes();
    buildTaskDevRoutes();
  }
}

export function buildRoutes() {
  if (appConfig) {
    routes.push({ path: 'home', component: UniversalOverlayComponent });
    routes.push({ path: 'guidedtask', loadChildren: () => GuideModule });

    if (appConfig.TPG_APP) {
      if (appConfig.TPG_APP.routes && appConfig.TPG_APP.routes.length > 0) {
        appConfig.TPG_APP.routes.forEach(route => {
          routes.push(route)
        });
      }
    } else {
      routes.push({ path: '', redirectTo: appConfig.TPG_PATH, pathMatch: 'full' });
      routes.push({ path: appConfig.TPG_PATH, loadChildren: () => appConfig.TPG_MODULE });
    }
  }
}

export function buildTaskDevRoutes() {
  if (appConfig && appConfig.TPG_APP) {
    if (appConfig.TPG_APP.routes && appConfig.TPG_APP.routes.length > 0) {
      appConfig.TPG_APP.routes.forEach(route => {
        if (route.path) {
          taskRoutes.push(route)
        }
      });
    }
  }

  (<any>window).DEV_ROUTES = taskRoutes;
}

loadAppConfig();


