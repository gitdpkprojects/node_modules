import { TranslateCompiler } from '@ngx-translate/core';
import * as mf from 'messageformat';
let MessageFormatStatic = (mf as any).default || mf;

/**
* This compiler expects ICU syntax and compiles the expressions with messageformat.js
*/
export class MessageFormatCompiler extends TranslateCompiler {
    private messageFormat: any;

    constructor() {
        super();
        this.messageFormat = new MessageFormatStatic().setIntlSupport(true);
    }

    /**
     * Compiles single translation into ICU message format
     */
    public compile(value: string, lang: string): string | Function {
        return this.messageFormat.compile(value, lang);
    }

    /**
     * Compiles all translations into ICU message format
     */
    public compileTranslations(translations: any, lang: string): any {
        return this.messageFormat.compile(translations, lang);
    }
}
